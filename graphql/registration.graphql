"Kiểu dữ liệu Registration"
type Registration {
    id: ID!
    user_id: String!
    event_id: String!
    registration_at: DateTime
    cancelled_at: DateTime
    queue_order: Int
    current_status: String
    cancel_reason: String
    code_roll_call: String
    is_attended: Boolean
    created_at: DateTime
    updated_at: DateTime
    user: User @belongsTo
    event: Event @belongsTo

    # Lịch sử trạng thái
    status_history: [RegistrationStatusHistory!]
}

"Object kiểu cho trạng thái registration"
type RegistrationStatusHistory {
    name: String!
    sequence: Int!
    changed_at: DateTime!
}

extend type Query {
    "Lấy tất cả registrations"
    registrations: [Registration!]! @all

    "Lấy registrations theo user_id"
    registrationsByUser(user_id: String!): [Registration!]!
        @middleware(checks: ["jwt.auth", "active"])
        @field(resolver: "App\\GraphQL\\Queries\\RegistrationResolver@byUser")
}

extend type Mutation {
    "Tạo registration mới"
    createRegistration(user_id: String!, event_id: String!): Registration!
        @middleware(checks: ["jwt.auth", "active"])
        @field(resolver: "App\\GraphQL\\Mutations\\RegistrationMutation@create")

    "Hủy registration"
    cancelRegistration(id: ID!, cancel_reason: String): Registration
        @middleware(checks: ["jwt.auth", "active"])
        @field(resolver: "App\\GraphQL\\Mutations\\RegistrationMutation@cancel")

    "Điểm danh bằng email và mã code"
    checkInRegistration(email: String!, code: String!): Registration!
        @field(
            resolver: "App\\GraphQL\\Mutations\\RegistrationMutation@checkIn"
        )
}
